# Runs of Homozygosity
Runs of Homozygosity (ROH) are continuous stretches of homozygous genotypes within an individual's genome, indicating that the segments are inherited from common ancestors. ROH can provide insights into the genetic history of populations, including levels of inbreeding, past population bottlenecks, and patterns of natural selection.


## What you need
The Runs of Homozygosity analysis uses **VCF files**, either a single file you already have or multiple files generated by the SwarmGenomics pipeline. A VCF (Variant Call Format) file contains information about genetic variants, such as SNPs and indels, across the genome for one or more samples.


### Installations
You need bcftools, which should already be installed, and download all_roh_bar_plots.R for plotting.
See [0.Installations](https://github.com/AureKylmanen/Swarmgenomics/blob/main/0.%20Installations.md) for instructions on installing bcftools.

Download R packages:
```
# Open R
R

# Install packages
# Choose CRAN mirror, e.g. 39
install.packages(c("ggplot2", "dplyr", "gridExtra", "data.table"))
```

## Running RoH analysis (SwarmGenomics pipeline)
The vcf files are separated by scaffolds in the preprocessing steps, but for RoH analysis, merging the files is required. If you are not following the pipeline and have a single vcf file, skip to step 2 and change the input file name accordingly.
```
# Step 0: Change directory to the VCF files
cd vcf

# Step 1: Merge multiple VCF files (skip if you have a single VCF)
bcftools merge --force-samples -O z -o merged.vcf.gz *.vcf.gz

# Step 2: Run bcftools RoH analysis
# Change the name of the vcf file if you didn't do the previous step
bcftools roh -G30 --AF-dflt 0.4 merged.vcf.gz > roh_results.txt

# Step 3: Extract only the RG lines (header + data)
grep -E "^# RG|^RG" roh_results.txt > RG.txt
```
- -G30 sets the minimum number of consecutive homozygous sites to call a RoH.

- --AF-dflt 0.4 sets the default allele frequency for sites without a known frequency.

- RG.txt will contain the filtered RoH results for further analysis.
### Plotting RoH results
```
# Plot RoHs
Rscript all_roh_bar_plots.R
```
## RoH results

The bar plot provides an overview of the **number** and **total length** of Runs of Homozygosity (ROH) in the following size categories:

- **<0.1 Mbp:** Represents short ROH, typically reflecting ancient homozygosity.  
- **0.1 – 1 Mbp:** ROH in this range often result from distant shared ancestry within a population.  
- **1 – 2 Mbp:** These ROH suggest closer relatedness, typically found in populations with some degree of inbreeding.  
- **>3 Mbp:** Long ROH indicate recent inbreeding, often due to mating between closely related individuals.

